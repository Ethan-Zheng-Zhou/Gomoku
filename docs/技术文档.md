# 五子棋游戏技术文档

## 1. 项目概述

### 1.1 项目简介

这是一个基于Java Swing开发的五子棋游戏，支持玩家对战和AI对战两种模式。游戏实现了标准的五子棋规则，包括基本的落子、判胜、悔棋等功能，以及AI对战功能。

### 1.2 主要功能

- 玩家对战模式

- AI对战模式

- 悔棋功能

- 游戏进度保存/加载

- 实时计时器

- 手数显示

- 棋局重置

## 2. 技术架构

## 2.1 核心结构

```
├── GomokuGame. Java       # 主程序入口
├── StartScreen. Java      # 开始界面
├── GameBoard. Java        # 游戏主界面
├── GameState. Java        # 游戏状态类
└── GomokuAI. Java         # AI 实现
```

### 2.2 依赖关系

- 基于Java Swing GUI框架

- 使用Java序列化机制实现存档功能

- 使用Java AWT进行图形绘制

## 3. 详细设计

### 3.1 StartScreen 类

开始界面的实现，提供游戏模式选择。

#### 主要属性

```Java
private static final Color BACKGROUND_COLOR = new Color(245, 245, 245);
private static final Color BUTTON_COLOR = new Color(70, 130, 180);
```

#### 核心功能

- 显示游戏标题

- 提供模式选择按钮

- 实现模式切换逻辑

### 3.2 GameBoard 类

游戏主界面的实现，包含棋盘绘制和游戏逻辑。

#### 主要常量

```Java
private static final int BOARD_SIZE = 15;
private static final int CELL_SIZE = 55;
private static final int MARGIN = 40;
```

#### 核心功能

- 棋盘管理

- 棋盘状态维护

- 落子验证

- 胜负判定

- 界面绘制

- 棋盘网格绘制

- 棋子绘制

- 动态更新

- 游戏控制

- 回合管理

- 计时器实现

- 悔棋功能

- 存档/读档

#### 核心算法

1. 评估函数

```Java
   private int evaluateBoard(int[][] board, int player)
```

- 计算当前局面分数

	- 考虑连子数量
	- 考虑威胁度

2. Alpha-Beta搜索

```Java
private Move alphaBeta(int[][] board, int depth, int alpha, int beta, boolean isMax, int player)
```

- 深度优先搜索
	- Alpha-Beta剪枝
	- 启发式评估


### 3.4 GameState 类

游戏状态的序列化实现。

#### 属性

```Java
public final int[][] board;
public final boolean isBlackTurn;
public final int blackTime;
public final int whiteTime;
```

## 4. 关键实现细节

### 4.1 棋盘绘制

```Java
protected void paintComponent(Graphics g) {
    Graphics2D g2 = (Graphics2D) g;
    g2.setRenderingHint(RenderingHints.KEY_ANTIALIASING, RenderingHints.VALUE_ANTIALIAS_ON);
    // 绘制网格和棋子
}
```

### 4.2 胜负判定

```Java
private boolean checkWin(int x, int y) {
    // 检查横、竖、斜四个方向
    // 统计连子数量
}
```

### 4.3 AI决策

```Java
public Move findBestMove(int[][] board, boolean isBlack) {
    // 使用Alpha-Beta算法搜索最佳落子位置
}
```

## 5. 存储设计

### 5.1 游戏存档

- 使用Java序列化机制

- 保存棋盘状态、回合信息和计时器状态

- 文件格式：.sav

### 5.2 内存数据

- 棋盘状态：`int [][]`
- 移动历史：`Stack<Move>`
- 计时数据：`int`

## 6. 界面设计

### 6.1 配色方案

```Java
private static final Color BACKGROUND_COLOR = new Color(245, 245, 245);
private static final Color BOARD_COLOR = new Color(210, 180, 140);
private static final Color GRID_COLOR = new Color(101, 67, 33);
```

### 6.2 布局设计

- 使用BorderLayout作为主布局

- 工具栏位于顶部

- 控制面板位于右侧

- 棋盘居中显示

## 7. 性能优化

### 7.1 AI优化

- 使用Alpha-Beta剪枝减少搜索空间

- 启发式评估提高决策质量

- 异步处理AI决策，避免界面卡顿

### 7.2 绘制优化

- 使用双缓冲减少闪烁

- 抗锯齿处理提升显示质量

## 8. 扩展性设计

### 8.1 可扩展部分

- AI算法替换

- 界面主题切换

- 网络对战功能

- 游戏规则变体

### 8.2 预留接口

- AI接口预留

- 主题切换接口

- 规则判定接口

## 9. 已知问题和优化方向

### 9.1 已知问题

- AI计算时间可能较长

- 部分边界情况的胜负判定需要优化

### 9.2 优化方向

- 优化AI算法效率

- 添加更多游戏特效

- 实现网络对战功能

- 增加游戏音效

- 添加更多主题选项

## 10. 部署说明

### 10.1 系统要求

- JDK 8 或更高版本

- 最小分辨率：1024x768

### 10.2 启动方式

```Java
javac GomokuGame.java
java GomokuGame
```

